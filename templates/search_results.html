{% extends 'base.html' %}
{% block content %}
<div class="container-fluid">

<h2 class="title">Results</h2>

{% if results %}
{% for result in results %}
	{% if result.get('elements') %}

	<h3 class="title"> {{ result['collectionName'] }} </h3>
	<img src="{{ result['artworkUrl60'] }}" /> 
	<br><br>

		{% for elem in result['elements'] %}
		
		<form action="add-track" method="POST">

			<div>
				{{ elem[1] }}
				<input type="hidden" name="title" value="{{ elem[1] }}">
				<input type="hidden" name="rss" value="{{ elem[0] }}">
			</div>

			{% if playlists %}	
				{% for playlist in playlists %}

					<div id="playlist{{ elem[1] }}">
						<input type="radio" name="playlist" value="{{ playlist.title }}" required>{{ playlist.title }}
						<input type="hidden" name="artist" value="{{ result['collectionName'] }}">

				{% endfor %}
				<input type="submit" value="+">
			</div>
				
			{% endif %}
		</form>

		{% endfor %}

	{% endif %}

{% endfor %}

<script>
	
	function getPlaylists() {
		$.get("/playlists.json", showPlaylists);
	}

	function showPlaylists(results) {
		let playlists = results;
		$("#playlist-popup").html(playlists);
	}

	$("#add-track").on('click', getPlaylists);

	// $(document).ready(function () {
	// 	$("[id*=playlist]").hide();
	// 	$("button").on('click', function() {
	// 		let id = $(this).attr("id");
	// 		let thisDiv = "#playlist" + id;
	// 		$(thisDiv).toggle();
	// 	});
	// });

</script>

{% endif %}
<br><br>

</div>
{% endblock %}

{% extends 'base.html' %}
{% block content %}
<div class="container-fluid">

<h2 class="title"> Hello, {{ user.fname }} </h2>

{% if img %}
<img height="200px" src="../static/images/{{img}}" /><br>
{% endif %}

<button class="btn btn-color" id="edit-btn">Edit profile</button>
<div id="edit-form">
	<form action="/upload" enctype="multipart/form-data" method="POST">
	  Select image: <input type="file" name="photo"><br>
	  <input type="submit" class="btn btn-color">
	</form>
</div>



<script>

$(document).ready(function () {
	$("[id*=show-tracks]").hide();
	$("button").on('click', function() {
		let id = $(this).attr("id");
		let thisDiv = "#show-tracks" + id;
		$(thisDiv).toggle();
	});

});

$(document).ready(function () {
	$("#edit-form").hide();
	$("#edit-btn").on('click', function() {
		$("#edit-form").toggle();
	});
});

$(document).ready(function () {
	$("#playlist-form").hide();
	$("#show-playlist-form").on('click', function() {
		$("#playlist-form").toggle();
	});
});

</script>


	<div id="playlist-parent">
	{% if playlists %}

	<h3 class="title"> Playlists </h3>
	{% for playlist in playlists %}
	<p id="playlist-para" style="font-size:18px"> <button class="btn-color" id="{{ playlist.playlist_id }}" class="btn" style="margin: 5px"> + </button> {{ playlist.title }}</p> 

		{% if playlist.tracks %}
		<div class="list-group" id="show-tracks{{ playlist.playlist_id }}">
			{% for track in playlist.tracks %}
			<div class="list-group-item">
			<h4 class="list-group-item-heading"> {{ track.artist }}: {{ track.title }} </h4>
			<p class="list-group-item-text"><audio controls src="{{ track.audio }}">Your browser doesn't support the audio element.</audio>
			</p>
			<form action="/delete-track" method="POST">
				<input type="submit" value="Delete"  id="delete-track">
				<input type="hidden" name="track_id" value="{{ track.track_id }}">
			</form>
			</div>
			
			{% endfor %}
		</div>
		{% endif %}

	{% endfor %}

	{% else %}
		<p> No playlists </p>
	{% endif %}
	</div>

	<button class="btn btn-color" id="show-playlist-form">Add Playlist</button>
	<div id="playlist-form">
		<form action="/add-playlist" method='post'>
			<input type="text" name="playlist-name" placeholder="Playlist name" required> <input type='submit' class="btn btn-color" id='new-playlist'>
		</form>
	</div>

	{% if friends %}
	<h3 class="title"> Friends </h3>
		{% for friend in friends %}
		<form action="/friend" method="GET">
			<input type="submit" class="btn" name="friend-profile" value="Visit {{ friend.username }}'s page">
			<input type="hidden" name="friend_id" value="{{ friend.user_id }}">
		</form>
		{% endfor %}
	{% endif %}
	<br>
	<form action="/search-users" method="GET">
		<input type="search" name="search-friends" placeholder="Search users" id="search-friends">
	<input type="submit" class="btn btn-color" value="Submit">
	</form>

</div>

<script>

	let delBtn = $("#delete-track");

	delBtn.on('click', function (evt) {
		evt.preventDefault()
		alert("Delete track");
	});

</script>

{% endblock %}
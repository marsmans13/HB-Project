{% extends 'base.html' %}
{% block content %}

<h2>Results</h2>

{% if results %}
{% for result in results %}

<!-- {% for r in result %}
<p> {{ r }}: {{ result[r] }}</p>
{% endfor %} -->

<p>Artist:  {{ result['artistName'] }} </p>
<h3>Collection:
</h3><a href="{{ result['trackViewUrl'] }}">{{ result['collectionName'] }}</a>
<br>
<img src="{{ result['artworkUrl60'] }}" /> 


{% if result.get('elements') %}
{% for elem in result['elements'] %}
<div>
<p> <a href="{{ elem[0] }}"> {{ elem[1] }} </a> 
	<form action="/add-track" method="POST">

		{% if playlists %}
			<div>
			{% for playlist in playlists %}

			{{ playlist.title }}<input type="radio" name="playlist" value="{{ playlist.title }}">

			{% endfor %}
			</div>
		{% endif %}

		<input type="submit" id="add-track" value="Add to Playlist"><span id="playlist-popup"></span>
		<input type="hidden" name="title" value="{{ elem[1] }}">
		<input type="hidden" name="rss" value="{{ elem[0] }}">
		<input type="hidden" name="artist" value="{{ result['collectionName'] }}">
</form>
</p>
</div>

<!-- <p> Link: {{ elem[0] }} </p> -->
{% endfor %}
{% endif %}

{% endfor %}

<script>
	
	function getPlaylists() {
		$.get("/playlists.json", showPlaylists);
	}

	function showPlaylists(results) {
		let playlists = results;
		$("#playlist-popup").html(playlists)
	}

	$("#add-track").on('click', getPlaylists);

</script>

{% endif %}
<br>

{% endblock %}
